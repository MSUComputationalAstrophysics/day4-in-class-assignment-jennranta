# In class Assignment #4
###### Jenn Ranta
###### PHY905

For this assignment, the Euler, Midpoint, and 4th-order Runge-Kutta methods of integration were tested against each other. The plots showing the solutions for each of the three methods for each of the three time steps compared to the analytical solution can be seen in `ica_04_eul_ranta.png`, `ica_04_mid_ranta.png`, and `ica_04_rk4_ranta.png` for the Euler, Midpoint, and Runge-Kutta methods (respectively)

As for the relative energy errors for each of the three methods, these results can be seen in `ica_04_error_ranta.png`. For the Euler method, the relative energy errors for the three times steps of 0.1π, 0.01π, and 0.001π are (respectively): 38.285, 0.48231, and 0.040258. For the Midpoint method, the relative energy errors are (respectively): 0.099503, 9.7170e-05, and 9.7385e-08. Lastly, for the Runge-Kutta method, the relative energy errors for the three times steps are (respectively): 5.1420e-4, 5.3270e-09, and 5.1514e-14. While all three methods decrease in relative energy error as the time step size decreases, the Euler method is certainly the least accurate method, followed by the Midpoint method, and the Runge-Kutta method was the most accurate.

In order for the relative energy errors to remain above 0.01% over the entire time interval from 0 to 4π, each of the methods need to utilize a maximum step size (a time step size of a certain value or smaller), which correlates to a minimum number of time steps to take (a number of time steps of a certain value or more). It was determined (by testing time steps that were consecutively smaller by an order of magnitude until the desired error percentage was reached) that in order to maintain a relative energy error less than or equal to 0.01%, the minimum number of time steps that must be taken (over this interval) was 1.57922e6 for the Euler method, 396.393 for the Midpoint method, and only 55.7079 for the Runge-Kutta method. These correspond to time steps sizes of 7.95735e-6 for Euler, 0.0317018 for Midpoint, and 0.225576 for Runge-Kutta. This shows that the Runge-Kutta method is significantly more accurate than the Euler method, as it needs 5 orders of magnitude less time steps to maintain the same level of relative error. The plot `ica_04_error_ranta2.png` displays the relative errors for each of the three methods over various time step sizes of 0.1π, 0.01π, 0.001π, 0.0001π, 0.00001π, and 0.000001π, as well as the desired error of 0.01% (shown as the dashed black line) and the respective time step values for each method that achieves this error percentage (shown as dashed lines of their respective line color).

For estimating the floating-point operations (flops) carried out by each method, a simple estimation of flops per iteration of each method was done simply by adding the adds and multiplies done per single iteration (divides and stores/loads were not considered for this estimate). For Euler there were 4 flops/iteration, for Midpoint there were 10 flops/iteration, and for Runge-Kutta there were 32 flops/iteration. Counting just these, and multiplying each method's flops per iteration by the minimum number of time steps required for relative error of no more than 0.01% (i.e. flops/iteration x number of iterations), then the total number of flops for each method was calculated. These values were 6.316862e6 flops for the Euler method, 3.96393e3 for the Midpoint method, and 1.78265e3 for the Runge-Kutta method. Thus, even though the Runge-Kutta (and Midpoint) method had 8 (2.5 for Midpoint) times as many flops per cycle than the Euler method does, it still ultimately performs 3 orders of magnitude less iterations to do the same integration to the same relative error percentage; once again, this demonstrates the inferiority of the first-order Euler method of integration.
